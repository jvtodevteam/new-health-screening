import{r as c,R as G,j as e}from"./app-C6_2iWa9.js";import{u as V}from"./useTranslation-DKQvB9zZ.js";import{X as K}from"./x-Dpd3dWzB.js";import{A as I}from"./arrow-left-DbmS5_Jo.js";import{D as Q}from"./dollar-sign-DpHUq0Py.js";import{C as U}from"./circle-alert-BSqP9vtq.js";import"./createLucideIcon-ClHtITnZ.js";const Z=({onClose:r,onLogin:i,isProcessing:d=!1})=>{const{t}=V(),[u,v]=c.useState(!1),[g,s]=c.useState(!1),[w,m]=c.useState(!1),[o,p]=c.useState(""),[x,f]=c.useState(["","","","","",""]),[j,h]=c.useState(""),[b,N]=c.useState(""),[E,O]=c.useState(!1),[_,P]=c.useState(!1),[R,L]=c.useState(0),k=Array(6).fill(0).map(()=>G.createRef()),A=()=>{v(!0);const n=600,a=600,l=(window.innerWidth-n)/2,S=(window.innerHeight-a)/2,y=window.open("/auth/google?ref=popup","googleLoginWindow",`width=${n},height=${a},top=${S},left=${l},menubar=no,toolbar=no,location=no,status=no`),C=setInterval(()=>{y&&y.closed&&(localStorage.getItem("google_login_success")==="true"?(localStorage.removeItem("google_login_success"),clearInterval(C),i()):localStorage.getItem("google_login_failed")==="true"&&(localStorage.removeItem("google_login_failed"),clearInterval(C),v(!1)))},500);window.loginCheckInterval=C},z=n=>{p(n.target.value),N("")},B=(n,a)=>{var y;const l=n.target.value;if(l&&!/^\d+$/.test(l))return;const S=[...x];S[a]=l.slice(0,1),f(S),h(""),l&&a<5&&((y=k[a+1].current)==null||y.focus())},F=(n,a)=>{var l;n.key==="Backspace"&&!x[a]&&a>0&&((l=k[a-1].current)==null||l.focus())},$=n=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n.toLowerCase()),T=async()=>{if(!o){N(t.emailRequired||"Email is required");return}if(!$(o)){N(t.invalidEmail||"Please enter a valid email");return}P(!0);try{await new Promise(a=>setTimeout(a,1e3)),m(!0),L(60);const n=setInterval(()=>{L(a=>a<=1?(clearInterval(n),0):a-1)},1e3)}catch(n){N(n.message||t.otpSendFailed||"Failed to send OTP")}finally{P(!1)}},W=async()=>{if(x.some(n=>!n)){h(t.completeOtp||"Please enter the complete OTP");return}O(!0);try{await new Promise(n=>setTimeout(n,1e3)),i()}catch(n){h(n.message||t.invalidOtp||"Invalid OTP")}finally{O(!1)}},M=()=>{s(!1),m(!1),p(""),f(["","","","","",""]),N(""),h("")},q=()=>{m(!1),f(["","","","","",""]),h("")};return c.useEffect(()=>()=>{window.loginCheckInterval&&clearInterval(window.loginCheckInterval)},[]),c.useEffect(()=>{if(new URLSearchParams(window.location.search).get("auth_success")==="true"){const l=window.location.pathname;window.history.replaceState({},document.title,l),i()}},[i]),!g&&!w?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end justify-center sm:items-center",children:e.jsx("div",{className:"bg-white rounded-t-xl sm:rounded-xl w-full max-w-md animate-slide-up",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t.loginToContinue}),e.jsx("button",{onClick:r,className:"text-gray-500",children:e.jsx(K,{size:24})})]}),e.jsx("div",{className:"space-y-4 mb-6",children:e.jsx("button",{onClick:A,className:"w-full bg-white border border-gray-300 py-3 px-6 rounded-xl flex items-center justify-center space-x-2 font-medium hover:bg-gray-50 transition-colors",disabled:d||u,children:d||u?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"w-5 h-5 border-2 border-gray-400 border-t-transparent rounded-full animate-spin mr-2"}),t.processing]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:"/assets/img/google.png",alt:"Google logo",className:"w-5 h-5"}),e.jsx("span",{className:"text-gray-700",children:t.loginWithGoogle})]})})}),e.jsxs("div",{className:"text-center text-gray-500 text-sm",children:[e.jsx("p",{children:t.continueAgreement}),e.jsxs("div",{className:"flex justify-center space-x-1",children:[e.jsx("a",{href:"/terms",className:"text-green-500",children:t.terms}),e.jsx("span",{children:"&"}),e.jsx("a",{href:"/privacy",className:"text-green-500",children:t.privacy})]})]})]})})}):g&&!w?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end justify-center sm:items-center",children:e.jsx("div",{className:"bg-white rounded-t-xl sm:rounded-xl w-full max-w-md animate-slide-up",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:M,className:"mr-3 text-gray-500",children:e.jsx(I,{size:24})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t.loginWithEmail||"Login with Email"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:t.emailAddress||"Email Address"}),e.jsx("input",{type:"email",id:"email",className:`w-full px-4 py-3 rounded-xl border ${b?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-green-500`,placeholder:t.enterEmail||"Enter your email address",value:o,onChange:z}),b&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:b})]}),e.jsx("button",{onClick:T,disabled:_,className:"w-full bg-green-500 text-white py-3 rounded-xl font-medium",children:_?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),t.sending||"Sending..."]}):t.sendOtp||"Send OTP"}),e.jsx("div",{className:"text-center text-gray-500 text-sm mt-6",children:e.jsx("p",{children:t.otpToEmail||"We will send a one-time password to your email"})})]})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end justify-center sm:items-center",children:e.jsx("div",{className:"bg-white rounded-t-xl sm:rounded-xl w-full max-w-md animate-slide-up",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:q,className:"mr-3 text-gray-500",children:e.jsx(I,{size:24})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t.verifyOtp||"Verify OTP"})]}),e.jsx("div",{className:"mb-3",children:e.jsxs("p",{className:"text-gray-700 text-sm",children:[t.otpSentTo||"We've sent a verification code to"," ",e.jsx("span",{className:"font-medium",children:o})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex justify-between gap-2 mb-2",children:x.map((n,a)=>e.jsx("input",{type:"text",ref:k[a],className:`w-12 h-12 text-center text-xl font-bold rounded-lg border ${j?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-green-500`,maxLength:1,value:n,onChange:l=>B(l,a),onKeyDown:l=>F(l,a)},a))}),j&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:j})]}),e.jsx("button",{onClick:W,disabled:E,className:"w-full bg-green-500 text-white py-3 rounded-xl font-medium",children:E?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),t.verifying||"Verifying..."]}):t.verify||"Verify"}),e.jsxs("div",{className:"text-center mt-6",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t.didntReceiveCode||"Didn't receive the code?"}),R>0?e.jsxs("p",{className:"text-sm text-gray-500",children:[t.resendIn||"Resend in"," ",R," ",t.seconds]}):e.jsx("button",{onClick:T,disabled:_,className:"text-green-500 font-medium text-sm",children:_?t.sending||"Sending...":t.resendOtp||"Resend OTP"})]})]})})})},te=({data:r,setData:i,errors:d,isProcessing:t,onSubmit:u,onBack:v,auth:g})=>{const{t:s}=V(),[w,m]=c.useState(!1),[o,p]=c.useState(!1),x=35e3,f=0,j=()=>x*r.participants.length+f,h=()=>{if(!(g!=null&&g.user)&&r.terms_agreed){m(!0);return}p(!0),u()},b=()=>{console.log("Login success - submitting form directly"),m(!1),p(!0),setTimeout(()=>{console.log("Calling onSubmit function"),u()},50)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsxs("div",{className:"bg-white p-4 flex items-center shadow-sm",children:[e.jsx("button",{onClick:v,className:"mr-2",children:e.jsx(I,{size:24,className:"text-gray-800"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:s.summary})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:[e.jsx("h2",{className:"font-bold text-lg mb-4 text-gray-800",children:s.screeningDetails}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg mb-3",children:[e.jsx("span",{className:"text-gray-700",children:s.location}),e.jsx("span",{className:"font-medium",children:r.location_name||"Selected Location"})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg mb-3",children:[e.jsx("span",{className:"text-gray-700",children:s.date}),e.jsx("span",{className:"font-medium",children:r.date})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg mb-3",children:[e.jsx("span",{className:"text-gray-700",children:s.time}),e.jsx("span",{className:"font-medium",children:r.time_slot_start&&r.time_slot_end?`${r.time_slot_start} - ${r.time_slot_end}`:"Selected Time"})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg mb-3",children:[e.jsx("span",{className:"text-gray-700",children:s.participants}),e.jsx("span",{className:"font-medium",children:r.participants.length})]}),e.jsx("h2",{className:"font-bold text-lg my-4 text-gray-800",children:s.payment}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer",onClick:()=>i("payment_method","spot"),children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-green-500 flex items-center justify-center mr-3",children:r.payment_method==="spot"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.payOnSpot||"Pay on the Spot"}),e.jsx("p",{className:"text-xs text-gray-500",children:s.payAtLocation||"Pay cash at the screening location"})]}),e.jsx("div",{children:e.jsx(Q,{size:20,className:"text-green-500"})})]}),e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer",onClick:()=>i("payment_method","card"),children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-green-500 flex items-center justify-center mr-3",children:r.payment_method==="card"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.creditCard}),e.jsx("p",{className:"text-xs text-gray-500",children:s.instantVerification})]}),e.jsx("div",{className:"flex space-x-1",children:e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/1280px-Mastercard-logo.svg.png",alt:"Mastercard",className:"h-8 w-auto object-contain"})})]}),e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer",onClick:()=>i("payment_method","qris"),children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-green-500 flex items-center justify-center mr-3",children:r.payment_method==="qris"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.qrisPayment}),e.jsx("p",{className:"text-xs text-gray-500",children:s.instantVerification})]}),e.jsx("div",{children:e.jsx("img",{src:"https://eg9mp7d8pz2.exactdn.com/wp-content/uploads/2022/12/QRIS__Quick_Response_Code_Indonesia_Standard__Logo__PNG2160p__-_Vector69Com-removebg-preview.png?strip=all&lossy=1&webp=85&ssl=1",alt:"QRIS",className:"h-6 w-auto object-contain"})})]}),e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer",onClick:()=>i("payment_method","ovo"),children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-green-500 flex items-center justify-center mr-3",children:r.payment_method==="ovo"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.ovoPayment}),e.jsx("p",{className:"text-xs text-gray-500",children:s.instantVerification})]}),e.jsx("div",{children:e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Logo_ovo_purple.svg/2560px-Logo_ovo_purple.svg.png",alt:"OVO",className:"h-5 w-auto object-contain"})})]}),e.jsx("div",{className:"pt-2 pb-1",children:e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:s.virtualAccount})}),e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer",onClick:()=>i("payment_method","bni"),children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-green-500 flex items-center justify-center mr-3",children:r.payment_method==="bni"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.bniVirtualAccount}),e.jsx("p",{className:"text-xs text-gray-500",children:s.instantVerification})]}),e.jsx("div",{children:e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/id/thumb/5/55/BNI_logo.svg/1200px-BNI_logo.svg.png",alt:"BNI",className:"h-5 w-auto object-contain"})})]}),e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer",onClick:()=>i("payment_method","bri"),children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-green-500 flex items-center justify-center mr-3",children:r.payment_method==="bri"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.briVirtualAccount}),e.jsx("p",{className:"text-xs text-gray-500",children:s.instantVerification})]}),e.jsx("div",{children:e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/6/68/BANK_BRI_logo.svg/2560px-BANK_BRI_logo.svg.png",alt:"BRI",className:"h-5 w-auto object-contain"})})]}),e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg cursor-pointer",onClick:()=>i("payment_method","mandiri"),children:[e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-green-500 flex items-center justify-center mr-3",children:r.payment_method==="mandiri"&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.mandiriVirtualAccount}),e.jsx("p",{className:"text-xs text-gray-500",children:s.instantVerification})]}),e.jsx("div",{children:e.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/a/ad/Bank_Mandiri_logo_2016.svg",alt:"Mandiri",className:"h-5 w-auto object-contain"})})]}),d.payment_method&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.payment_method})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-gray-700",children:s.screeningFee}),e.jsxs("span",{children:["Rp ",x.toLocaleString()," x"," ",r.participants.length]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg mt-4",children:[e.jsx("span",{children:s.total}),e.jsxs("span",{children:["Rp ",j().toLocaleString()]})]})]}),e.jsxs("div",{className:"mb-4 mt-6",children:[e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(U,{size:18,className:"text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-yellow-800",children:s.dataExpiryWarning})]})}),e.jsxs("div",{className:"flex items-start cursor-pointer",onClick:()=>i("terms_agreed",!r.terms_agreed),children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{type:"checkbox",checked:r.terms_agreed,onChange:()=>i("terms_agreed",!r.terms_agreed),className:"w-4 h-4 border border-gray-300 rounded accent-green-500"})}),e.jsx("div",{className:"ml-3 text-sm",children:e.jsxs("label",{className:"text-gray-700",children:[s.agreeToTerms,e.jsx("a",{href:route("terms"),className:"text-green-500 hover:underline ml-1",children:s.terms}),s.and,e.jsx("a",{href:route("privacy"),className:"text-green-500 hover:underline ml-1",children:s.privacy})]})})]}),d.terms_agreed&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.terms_agreed})]}),e.jsx("button",{onClick:h,className:`w-full ${r.terms_agreed&&r.payment_method?"bg-green-500 text-white":"bg-gray-300 text-gray-500"} py-3 rounded-xl font-medium`,disabled:!r.terms_agreed||!r.payment_method||o||t,children:o||t?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),s.processing]}):s.submit})]})}),w&&e.jsx(Z,{onClose:()=>m(!1),onLogin:b,isProcessing:o})]})};export{te as default};
