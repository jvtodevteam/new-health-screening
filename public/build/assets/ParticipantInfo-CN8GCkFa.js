import{r as p,j as e}from"./app-C6_2iWa9.js";import{u as v}from"./useTranslation-DKQvB9zZ.js";import{C as w}from"./chevron-up--TfTIVD6.js";import{C as $}from"./chevron-down-BEnUl3nv.js";import{S as C}from"./search-a3qW2BJr.js";import{A as k}from"./arrow-left-DbmS5_Jo.js";import{X as S}from"./x-Dpd3dWzB.js";import{P}from"./plus-CAhOzZ8H.js";import"./createLucideIcon-ClHtITnZ.js";const Y=({options:d,selectedOption:m,onSelect:g,placeholder:c="Select an option...",hasError:x=!1,errorMessage:y=""})=>{const[r,i]=p.useState(""),[u,h]=p.useState(!1),b=p.useRef(null),f=d.filter(n=>n.name.toLowerCase().includes(r.toLowerCase())),o=n=>{g(n),i(""),h(!1)};return p.useEffect(()=>{const n=j=>{b.current&&!b.current.contains(j.target)&&h(!1)};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[]),e.jsxs("div",{className:"relative w-full",ref:b,children:[e.jsxs("div",{className:`flex items-center justify-between p-3 border ${x?"border-red-500":"border-gray-300"} rounded-lg bg-white cursor-pointer`,onClick:()=>h(!u),children:[e.jsx("div",{className:"flex-1 truncate",children:m?m.name:c}),e.jsx("div",{children:u?e.jsx(w,{size:18}):e.jsx($,{size:18})})]}),u&&e.jsxs("div",{className:"absolute w-full mt-1 border border-gray-300 rounded-lg bg-white shadow-lg z-10",children:[e.jsx("div",{className:"p-2 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-2 top-2 text-gray-400",size:16}),e.jsx("input",{type:"text",value:r,onChange:n=>i(n.target.value),placeholder:"Search options...",className:"w-full pl-8 p-2 border border-gray-300 rounded-lg",autoFocus:!0})]})}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:f.length>0?f.map(n=>e.jsx("div",{className:`p-3 cursor-pointer hover:bg-gray-100 ${m&&m.id===n.id?"bg-blue-100":""}`,onClick:()=>o(n),children:n.name},n.id)):e.jsx("div",{className:"p-3 text-gray-500",children:"No options found"})})]}),x&&y&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:y})]})},R=({data:d,setData:m,nationalities:g,errors:c,onNext:x,onBack:y})=>{const{t:r}=v(),[i,u]=p.useState({}),h=(a,t,s)=>{const l={...i};t?a==101&&!/^\d{16}$/.test(t)?l[`idNumber_${s}`]="KTP must be 16 digits":a!=101&&!/^[A-Z0-9]{8,9}$/.test(t)?l[`idNumber_${s}`]="Passport must be 8-9 characters":delete l[`idNumber_${s}`]:l[`idNumber_${s}`]="ID number is required",u(l)},b=(a,t)=>{const s={...i};a?/\d/.test(a)?s[`name_${t}`]="Name cannot contain numbers":delete s[`name_${t}`]:s[`name_${t}`]="Name is required",u(s)},f=(a,t)=>{const s={...i},l=new Date().getFullYear();a?isNaN(a)?s[`birthYear_${t}`]="Birth year must be a number":parseInt(a)<1900||parseInt(a)>l?s[`birthYear_${t}`]=`Birth year must be between 1900 and ${l}`:delete s[`birthYear_${t}`]:s[`birthYear_${t}`]="Birth year is required",u(s)},o=(a,t,s)=>{const l=[...d.participants];l[a]={...l[a],[t]:s},m("participants",l),t=="id_number"&&h(l[a].nationality_id,s,a),t=="nationality_id"&&h(s,l[a].id_number,a),t=="name"&&b(s,a),t=="birth_year"&&f(s,a)},n=()=>{const a=[...d.participants];a.push({title:"Mr",name:"",birth_year:"",nationality_id:"",id_number:"",has_medical_history:!1,allergies:"",past_medical_history:"",current_medications:"",family_medical_history:""}),m("participants",a)},j=a=>{if(d.participants.length>1){const t=d.participants.filter((l,N)=>N!==a);m("participants",t);const s={...i};Object.keys(s).forEach(l=>{l.endsWith(`_${a}`)&&delete s[l]}),u(s)}},_=()=>d.participants.every(a=>a.name&&a.birth_year&&a.nationality_id&&a.id_number)&&Object.keys(i).length==0;return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsxs("div",{className:"bg-white p-4 flex items-center shadow-sm",children:[e.jsx("button",{onClick:y,className:"mr-2",children:e.jsx(k,{size:24,className:"text-gray-800"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:r.participantInfo})]}),e.jsxs("div",{className:"p-6",children:[d.participants.map((a,t)=>e.jsxs("div",{className:"bg-white border shadow-sm rounded-xl shadow-sm p-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"font-bold text-lg text-gray-800",children:[r.participantInfo," ",t+1]}),t>0&&e.jsx("button",{className:"text-red-500",onClick:()=>j(t),children:e.jsx(S,{size:20})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.title}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg p-3",value:a.title||"Mr",onChange:s=>o(t,"title",s.target.value),children:[e.jsx("option",{children:"Mr"}),e.jsx("option",{children:"Mrs"}),e.jsx("option",{children:"Ms"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.name}),e.jsx("input",{type:"text",value:a.name||"",onChange:s=>o(t,"name",s.target.value),className:`w-full border ${i[`name_${t}`]||c[`participants.${t}.name`]?"border-red-500":"border-gray-300"} rounded-lg p-3`}),(i[`name_${t}`]||c[`participants.${t}.name`])&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i[`name_${t}`]||c[`participants.${t}.name`]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.birthYear}),e.jsx("input",{type:"number",value:a.birth_year||"",onChange:s=>o(t,"birth_year",s.target.value),className:`w-full border ${i[`birthYear_${t}`]||c[`participants.${t}.birth_year`]?"border-red-500":"border-gray-300"} rounded-lg p-3`,placeholder:r.birthYearPlaceholder,min:"1900",max:new Date().getFullYear()}),(i[`birthYear_${t}`]||c[`participants.${t}.birth_year`])&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i[`birthYear_${t}`]||c[`participants.${t}.birth_year`]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.nationality}),e.jsx(Y,{options:g,selectedOption:g.find(s=>s.id.toString()==a.nationality_id.toString()),onSelect:s=>o(t,"nationality_id",s.id.toString()),placeholder:"Select nationality...",hasError:!!c[`participants.${t}.nationality_id`],errorMessage:c[`participants.${t}.nationality_id`]})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a.nationality_id==101?"KTP Number":"Passport Number"}),e.jsx("input",{type:"text",value:a.id_number||"",onChange:s=>o(t,"id_number",s.target.value),className:`w-full border ${i[`idNumber_${t}`]||c[`participants.${t}.id_number`]?"border-red-500":"border-gray-300"} rounded-lg p-3`,placeholder:a.nationality_id==101?"16 digits":"8-9 characters"}),(i[`idNumber_${t}`]||c[`participants.${t}.id_number`])&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i[`idNumber_${t}`]||c[`participants.${t}.id_number`]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a.nationality_id==101?r.ktpValidation:r.passportValidation})]})}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-700",children:r.medicalHistory}),e.jsx("div",{className:`w-12 h-6 rounded-full ${a.has_medical_history?"bg-green-500":"bg-gray-300"} flex items-center p-1 transition-all duration-200 cursor-pointer`,onClick:()=>o(t,"has_medical_history",!a.has_medical_history),children:e.jsx("div",{className:`w-4 h-4 rounded-full bg-white transform transition-all duration-200 ${a.has_medical_history?"translate-x-6":""}`})})]}),a.has_medical_history&&e.jsxs("div",{className:"space-y-4 p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.allergies}),e.jsx("input",{type:"text",value:a.allergies||"",onChange:s=>o(t,"allergies",s.target.value),className:"w-full border border-gray-300 rounded-lg p-3",placeholder:"List any allergies"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.pastMedical}),e.jsx("textarea",{value:a.past_medical_history||"",onChange:s=>o(t,"past_medical_history",s.target.value),className:"w-full border border-gray-300 rounded-lg p-3",rows:2,placeholder:"Describe any past medical conditions"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.currentMeds}),e.jsx("input",{type:"text",value:a.current_medications||"",onChange:s=>o(t,"current_medications",s.target.value),className:"w-full border border-gray-300 rounded-lg p-3",placeholder:"List current medications"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.familyMedical}),e.jsx("textarea",{value:a.family_medical_history||"",onChange:s=>o(t,"family_medical_history",s.target.value),className:"w-full border border-gray-300 rounded-lg p-3",rows:2,placeholder:"Any relevant family medical history"})]})]})]})]},t)),e.jsxs("button",{onClick:n,className:"w-full mb-4 border-2 border-dashed border-green-300 text-green-500 py-3 rounded-xl font-medium flex items-center justify-center",children:[e.jsx(P,{size:20,className:"mr-2"}),r.addParticipant]}),e.jsx("button",{onClick:x,className:`w-full ${_()?"bg-green-500 text-white":"bg-gray-300 text-gray-500"} py-3 rounded-xl font-medium mb-6`,disabled:!_(),children:r.next})]})]})};export{R as default};
