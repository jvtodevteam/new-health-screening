import{r as p,j as e}from"./app-ClWzvfuZ.js";import{u as v}from"./useTranslation-ia2vs2-L.js";import{C as w}from"./chevron-up-X_YlSjmA.js";import{C as $}from"./chevron-down-DkkbmBDI.js";import{S as C}from"./search-DqcE8Gq0.js";import{A as k}from"./arrow-left-CU7khLPQ.js";import{X as S}from"./x-D7i2mKT4.js";import{P}from"./plus-DHBTqTwg.js";import"./createLucideIcon-DNKM7-_k.js";const Y=({options:d,selectedOption:m,onSelect:g,placeholder:c="Select an option...",hasError:x=!1,errorMessage:y=""})=>{const[r,i]=p.useState(""),[h,u]=p.useState(!1),b=p.useRef(null),f=d.filter(n=>n.name.toLowerCase().includes(r.toLowerCase())),o=n=>{g(n),i(""),u(!1)};return p.useEffect(()=>{const n=j=>{b.current&&!b.current.contains(j.target)&&u(!1)};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[]),e.jsxs("div",{className:"relative w-full",ref:b,children:[e.jsxs("div",{className:`flex items-center justify-between p-3 border ${x?"border-red-500":"border-gray-300"} rounded-lg bg-white cursor-pointer`,onClick:()=>u(!h),children:[e.jsx("div",{className:"flex-1 truncate",children:m?m.name:c}),e.jsx("div",{children:h?e.jsx(w,{size:18}):e.jsx($,{size:18})})]}),h&&e.jsxs("div",{className:"absolute w-full mt-1 border border-gray-300 rounded-lg bg-white shadow-lg z-10",children:[e.jsx("div",{className:"p-2 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-2 top-2 text-gray-400",size:16}),e.jsx("input",{type:"text",value:r,onChange:n=>i(n.target.value),placeholder:"Search options...",className:"w-full pl-8 p-2 border border-gray-300 rounded-lg",autoFocus:!0})]})}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:f.length>0?f.map(n=>e.jsx("div",{className:`p-3 cursor-pointer hover:bg-gray-100 ${m&&m.id===n.id?"bg-blue-100":""}`,onClick:()=>o(n),children:n.name},n.id)):e.jsx("div",{className:"p-3 text-gray-500",children:"No options found"})})]}),x&&y&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:y})]})},R=({data:d,setData:m,nationalities:g,errors:c,onNext:x,onBack:y})=>{const{t:r}=v(),[i,h]=p.useState({}),u=(s,t,a)=>{const l={...i};t?s==101&&!/^\d{16}$/.test(t)?l[`idNumber_${a}`]="KTP must be 16 digits":s!=101&&!/^[A-Z0-9]{8,9}$/.test(t)?l[`idNumber_${a}`]="Passport must be 8-9 characters":delete l[`idNumber_${a}`]:l[`idNumber_${a}`]="ID number is required",h(l)},b=(s,t)=>{const a={...i};s?/\d/.test(s)?a[`name_${t}`]="Name cannot contain numbers":delete a[`name_${t}`]:a[`name_${t}`]="Name is required",h(a)},f=(s,t)=>{const a={...i},l=new Date().getFullYear();s?isNaN(s)?a[`birthYear_${t}`]="Birth year must be a number":parseInt(s)<1900||parseInt(s)>l?a[`birthYear_${t}`]=`Birth year must be between 1900 and ${l}`:delete a[`birthYear_${t}`]:a[`birthYear_${t}`]="Birth year is required",h(a)},o=(s,t,a)=>{const l=[...d.participants];l[s]={...l[s],[t]:a},m("participants",l),t=="id_number"&&u(l[s].nationality_id,a,s),t=="nationality_id"&&u(a,l[s].id_number,s),t=="name"&&b(a,s),t=="birth_year"&&f(a,s)},n=()=>{if(d.participants.length<10){const s=[...d.participants];s.push({title:"Mr",name:"",birth_year:"",nationality_id:"",id_number:"",has_medical_history:!1,allergies:"",past_medical_history:"",current_medications:"",family_medical_history:""}),m("participants",s)}},j=s=>{if(d.participants.length>1){const t=d.participants.filter((l,N)=>N!==s);m("participants",t);const a={...i};Object.keys(a).forEach(l=>{l.endsWith(`_${s}`)&&delete a[l]}),h(a)}},_=()=>d.participants.every(s=>s.name&&s.birth_year&&s.nationality_id&&s.id_number)&&Object.keys(i).length==0;return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsxs("div",{className:"bg-white p-4 flex items-center shadow-sm",children:[e.jsx("button",{onClick:y,className:"mr-2",children:e.jsx(k,{size:24,className:"text-gray-800"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:r.participantInfo})]}),e.jsxs("div",{className:"p-6",children:[d.participants.map((s,t)=>e.jsxs("div",{className:"bg-white border shadow-sm rounded-xl shadow-sm p-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"font-bold text-lg text-gray-800",children:[r.participantInfo," ",t+1]}),t>0&&e.jsx("button",{className:"text-red-500",onClick:()=>j(t),children:e.jsx(S,{size:20})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.title}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg p-3",value:s.title||"Mr",onChange:a=>o(t,"title",a.target.value),children:[e.jsx("option",{children:"Mr"}),e.jsx("option",{children:"Mrs"}),e.jsx("option",{children:"Ms"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.name}),e.jsx("input",{type:"text",value:s.name||"",onChange:a=>o(t,"name",a.target.value),className:`w-full border ${i[`name_${t}`]||c[`participants.${t}.name`]?"border-red-500":"border-gray-300"} rounded-lg p-3`}),(i[`name_${t}`]||c[`participants.${t}.name`])&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i[`name_${t}`]||c[`participants.${t}.name`]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"w-24",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.birthYear}),e.jsx("input",{type:"number",value:s.birth_year||"",onChange:a=>o(t,"birth_year",a.target.value),className:`w-full border ${i[`birthYear_${t}`]||c[`participants.${t}.birth_year`]?"border-red-500":"border-gray-300"} rounded-lg p-3`,placeholder:r.birthYearPlaceholder,min:"1900",max:new Date().getFullYear()}),(i[`birthYear_${t}`]||c[`participants.${t}.birth_year`])&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i[`birthYear_${t}`]||c[`participants.${t}.birth_year`]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.nationality}),e.jsx(Y,{options:g,selectedOption:g.find(a=>a.id.toString()==s.nationality_id.toString()),onSelect:a=>o(t,"nationality_id",a.id.toString()),placeholder:"Select nationality...",hasError:!!c[`participants.${t}.nationality_id`],errorMessage:c[`participants.${t}.nationality_id`]})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.nationality_id==101?"KTP Number":"Passport Number"}),e.jsx("input",{type:"text",value:s.id_number||"",onChange:a=>o(t,"id_number",a.target.value),className:`w-full border ${i[`idNumber_${t}`]||c[`participants.${t}.id_number`]?"border-red-500":"border-gray-300"} rounded-lg p-3`,placeholder:s.nationality_id==101?"16 digits":"8-9 characters"}),(i[`idNumber_${t}`]||c[`participants.${t}.id_number`])&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:i[`idNumber_${t}`]||c[`participants.${t}.id_number`]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.nationality_id==101?r.ktpValidation:r.passportValidation})]})}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-gray-700",children:r.medicalHistory}),e.jsx("div",{className:`w-12 h-6 rounded-full ${s.has_medical_history?"bg-green-500":"bg-gray-300"} flex items-center p-1 transition-all duration-200 cursor-pointer`,onClick:()=>o(t,"has_medical_history",!s.has_medical_history),children:e.jsx("div",{className:`w-4 h-4 rounded-full bg-white transform transition-all duration-200 ${s.has_medical_history?"translate-x-6":""}`})})]}),s.has_medical_history&&e.jsxs("div",{className:"space-y-4 p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.allergies}),e.jsx("input",{type:"text",value:s.allergies||"",onChange:a=>o(t,"allergies",a.target.value),className:"w-full border border-gray-300 rounded-lg p-3",placeholder:"List any allergies"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.pastMedical}),e.jsx("textarea",{value:s.past_medical_history||"",onChange:a=>o(t,"past_medical_history",a.target.value),className:"w-full border border-gray-300 rounded-lg p-3",rows:2,placeholder:"Describe any past medical conditions"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.currentMeds}),e.jsx("input",{type:"text",value:s.current_medications||"",onChange:a=>o(t,"current_medications",a.target.value),className:"w-full border border-gray-300 rounded-lg p-3",placeholder:"List current medications"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r.familyMedical}),e.jsx("textarea",{value:s.family_medical_history||"",onChange:a=>o(t,"family_medical_history",a.target.value),className:"w-full border border-gray-300 rounded-lg p-3",rows:2,placeholder:"Any relevant family medical history"})]})]})]})]},t)),d.participants.length<10&&e.jsxs("button",{onClick:n,className:"w-full mb-4 border-2 border-dashed border-green-300 text-green-500 py-3 rounded-xl font-medium flex items-center justify-center",children:[e.jsx(P,{size:20,className:"mr-2"}),r.addParticipant," (",d.participants.length,"/10)"]}),e.jsx("button",{onClick:x,className:`w-full ${_()?"bg-green-500 text-white":"bg-gray-300 text-gray-500"} py-3 rounded-xl font-medium mb-6`,disabled:!_(),children:r.next})]})]})};export{R as default};
